#!/bin/bash

# Define the block of imports to add
IMPORT_BLOCK="import { CommonModule, DatePipe } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport { A11yModule } from '@angular/cdk/a11y';\nimport { ClipboardModule } from '@angular/cdk/clipboard';\nimport { CdkStepperModule } from '@angular/cdk/stepper';\nimport { CdkTableModule } from '@angular/cdk/table';\nimport { CdkTreeModule } from '@angular/cdk/tree';\nimport { DragDropModule } from '@angular/cdk/drag-drop';\nimport { OverlayModule } from '@angular/cdk/overlay';\nimport { PortalModule } from '@angular/cdk/portal';\nimport { ScrollingModule } from '@angular/cdk/scrolling';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatBadgeModule } from '@angular/material/badge';\nimport { MatBottomSheetModule } from '@angular/material/bottom-sheet';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatButtonToggleModule } from '@angular/material/button-toggle';\nimport { MatCardModule } from '@angular/material/card';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatStepperModule } from '@angular/material/stepper';\nimport { MatDatepickerModule } from '@angular/material/datepicker';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatDividerModule } from '@angular/material/divider';\nimport { MatExpansionModule } from '@angular/material/expansion';\nimport { MatGridListModule } from '@angular/material/grid-list';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatListModule } from '@angular/material/list';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatNativeDateModule, MatRippleModule } from '@angular/material/core';\nimport { MatPaginatorModule } from '@angular/material/paginator';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatSidenavModule } from '@angular/material/sidenav';\nimport { MatSliderModule } from '@angular/material/slider';\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatSortModule } from '@angular/material/sort';\nimport { MatTableModule } from '@angular/material/table';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatToolbarModule } from '@angular/material/toolbar';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatTreeModule } from '@angular/material/tree';\nimport { CarouselModule } from 'ngx-owl-carousel-o';\nimport { NgxSliderModule } from '@angular-slider/ngx-slider';\nimport { NgbRatingModule, NgbCarouselModule, NgbDropdown } from '@ng-bootstrap/ng-bootstrap';\nimport { NgChartsModule } from 'ng2-charts';\nimport { NgxBarcode6Module } from 'ngx-barcode6';"

# Define the standalone properties to add
STANDALONE_PROPS="  standalone: true,\\n  imports: [\\n    CommonModule,\\n    FormsModule,\\n    ReactiveFormsModule,\\n    RouterModule,\\n    A11yModule,\\n    ClipboardModule,\\n    CdkStepperModule,\\n    CdkTableModule,\\n    CdkTreeModule,\\n    DragDropModule,\\n    OverlayModule,\\n    PortalModule,\\n    ScrollingModule,\\n    MatAutocompleteModule,\\n    MatBadgeModule,\\n    MatBottomSheetModule,\\n    MatButtonModule,\\n    MatButtonToggleModule,\\n    MatCardModule,\\n    MatCheckboxModule,\\n    MatChipsModule,\\n    MatStepperModule,\\n    MatDatepickerModule,\\n    MatDialogModule,\\n    MatDividerModule,\\n    MatExpansionModule,\\n    MatGridListModule,\\n    MatIconModule,\\n    MatInputModule,\\n    MatListModule,\\n    MatMenuModule,\\n    MatNativeDateModule,\\n    MatPaginatorModule,\\n    MatProgressBarModule,\\n    MatProgressSpinnerModule,\\n    MatRadioModule,\\n    MatRippleModule,\\n    MatSelectModule,\\n    MatSidenavModule,\\n    MatSliderModule,\\n    MatSlideToggleModule,\\n    MatSnackBarModule,\\n    MatSortModule,\\n    MatTableModule,\\n    MatTabsModule,\\n    MatToolbarModule,\\n    MatTooltipModule,\\n    MatTreeModule,\\n    CarouselModule,\\n    NgxSliderModule,\\n    NgbRatingModule,\\n    NgbCarouselModule,\\n    NgbDropdown,\\n    NgChartsModule,\\n    NgxBarcode6Module\\n  ],"

# Find all component files and process them
find src/app -name "*.component.ts" ! -name "app.component.ts" | while read -r file; do
  echo "Processing $file"
  # Add the standalone properties to the @Component decorator
  sed -i "/styleUrls: \['.*'\],/a ${STANDALONE_PROPS}" "$file"
  # Add the import block after the first line (usually import { Component })
  sed -i "1a ${IMPORT_BLOCK}" "$file"
done

echo "Refactoring complete."
